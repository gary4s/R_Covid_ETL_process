
Attaching package: 'dplyr'

The following objects are masked from 'package:stats':

    filter, lag

The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union


Attaching package: 'lubridate'

The following objects are masked from 'package:base':

    date, intersect, setdiff, union

Attempting to connect to the database...
Successfully connected to the database!
Connection remains open for further operations.
Starting Excel to CSV file conversion process...
Processing files in: C:/Users/gary4/Documents/Data Engineering/Portfolio/ETL Covid project/Health Roster data import
Reading file: Heath_Roster - 2025-05-01.xlsx
File 'Heath_Roster - 2025-05-01.xlsx' has no 'Report Date' column. Saved as 'Heath_Roster - 2025-05-01.csv' in export folder.
Moved file 'Heath_Roster - 2025-05-01.xlsx' to 'C:/Users/gary4/Documents/Data Engineering/Portfolio/ETL Covid project/Received data'
Starting main ETL loop...
ETL Cycle
Current ETL Report Date identified: 2025-05-01
Truncating report date table
Report date '2025-05-01' loaded to SQL table 'Covid19-Report-Date' for current ETL cycle.
Searching for files with date pattern: 2025-05-01
Found MedSus file: BI_Medical_Suspensions_Export_Daily_Covid19 - 2025-05-01.csv
Found Org file: BI_Organisation_Absence_Export_Daily_Covid19 - 2025-05-01.csv
Found HealthRoster file: Heath_Roster - 2025-05-01.csv
Rows: 484 Columns: 42
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (26): Last Name, First Name, Assignment Category, Assignment Number, Pri...
dbl (11): Employee, FTE, Total Days Lost, Total Days Lost Per Assignment, Ca...
lgl  (5): Title, Predicted Fitness Date, Third Party, Afc Annual Leave, Noti...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
-> [SUCCESS] All required columns found in Org file.
Rows: 20 Columns: 42
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (20): Last Name, First Name, Assignment Category, Assignment Number, Pri...
dbl (11): Employee, FTE, Total Days Lost, Total Days Lost Per Assignment, Ca...
lgl (11): Title, Predicted Fitness Date, Third Party, Return To Work Discuss...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
-> [SUCCESS] All required columns found in MedSus file.
Rows: 523 Columns: 36
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (25): Unit Long Name, Cost Centre, Unit, Unlocked, Surname, Forenames, ...
dbl   (3): Staff Number, Hours In Period, Total Duration
lgl   (1): Name
dttm  (6): Submitted Upto Date, Start, End, Requested Date, Occ Health Refer...
time  (1): Hours In Period (hh:mm)

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
-> [SUCCESS] All required columns found in Health_Roster file.
Successfully read: BI_Organisation_Absence_Export_Daily_Covid19 - 2025-05-01.csv
Moved file 'BI_Organisation_Absence_Export_Daily_Covid19 - 2025-05-01.csv' to 'C:/Users/gary4/Documents/Data Engineering/Portfolio/ETL Covid project/Received data'
Truncating table: BI_Organisation_Absence_Import_Daily_Covid19
BI_Organisation_Absence_Import_Daily_Covid19 data uploaded successfully!
Successfully read: BI_Medical_Suspensions_Export_Daily_Covid19 - 2025-05-01.csv
Moved file 'BI_Medical_Suspensions_Export_Daily_Covid19 - 2025-05-01.csv' to 'C:/Users/gary4/Documents/Data Engineering/Portfolio/ETL Covid project/Received data'
Truncating table: BI_Medical_Suspensions_Import_Daily_Covid19
BI_Medical_Suspensions_Import_Daily_Covid19 data uploaded successfully!
Successfully read: Heath_Roster - 2025-05-01.csv
Moved file 'Heath_Roster - 2025-05-01.csv' to 'C:/Users/gary4/Documents/Data Engineering/Portfolio/ETL Covid project/Received data'
Truncating table: Healthroster_Absence_Import_Daily_Covid19
Healthroster_Absence_Import_Daily_Covid19 data upload failed! Error: nanodbc/nanodbc.cpp:1867: 22018
[Microsoft][ODBC Driver 17 for SQL Server]Invalid character value for cast specification 
Stored procedure 'Covid19_UpdateAll' executed successfully!
Stored Procedure run at: 2025-10-21 09:37:35.267
Warning message:
There were 2 warnings in `mutate()`.
The first warning was:
ℹ In argument: `Start = lubridate::as_date(lubridate::dmy(Start))`.
Caused by warning:
! All formats failed to parse. No formats found.
ℹ Run `dplyr::last_dplyr_warnings()` to see the 1 remaining warning. 
ETL process completed or no more files to process.
Database connection closed.
